| 寄存器        | ABI 名称 （别名） | 解释                           |
| ------------- | ----------------- | ------------------------------ |
| `pc`          | `pc`              | 程序计数器（下一条指令的位置） |
| `x0`          | `zero`            | 硬连线零（始终读为零）         |
| `x1`          | `ra`              | 返回地址                       |
| `x2`          | `sp`              | 栈指针                         |
| `x5` - `x7`   | `t0` - `t2`       | 临时寄存器                     |
| `x8`          | `fp`              | 栈帧指针                       |
| `x10` - `x11` | `a0` - `a1`       | 函数参数/返回值                |
| `x12` - `x17` | `a2` - `a7`       | 函数参数                       |
| `x18` - `x27` | `s0` - `s11`      | 调用期间保存的临时寄存器       |
| `x28` - `x31` | `t3` - `t6`       | 临时寄存器                     |

入栈（栈分配）

```
addi sp, sp, -4  # 将栈指针向下移动 4 字节
sw   a0, (sp)    # 将 a0 保存到栈
```

出栈（栈释放）

```
    lw   a0, (sp)    # 从栈中读取到 a0
    addi sp, sp, 4   # 将栈指针向上移动 4 字节
```

函数调用，以下面的简单代码为例

```c
int func(int a) {
  a += 1;
  return a;
}

void main(void){
    func(233);
}
```

[编译器](https://godbolt.org/)可以优化成这样（或者手写汇编）

```
func:
        addi    a0,a0,1   # 返回值保存在 a0 寄存器中
        ret               # 返回到 ra 保存的地址
main:
        li      a0,233    # 填充函数参数
        jal     ra, func  # 跳转到 func 并且将返回地址保存到 ra 寄存器中
        nop
```

若不优化，则所有函数体都可以通用地编译为如下：

```
func:
    addi    sp, sp, -32  # 分配栈空间：将栈指针 (sp) 减去 32 字节，为函数调用分配栈帧。
    sw      ra, 28(sp)   # 保存返回地址：将返回地址寄存器 (ra) 的值保存到栈中，偏移量为 28 字节。  这是为了在函数返回时能够回到调用者。
    sw      s0, 24(sp)   # 保存帧指针：将帧指针寄存器 (s0) 的值保存到栈中，偏移量为 24 字节。  s0 用于恢复调用者的栈帧。
    addi    s0, sp, 32   # 设置帧指针：将帧指针寄存器 (s0) 设置为当前栈帧的起始地址 (sp + 32)。  s0 指向栈帧的底部，方便访问局部变量。
    sw      a0, -20(s0)  # 保存参数：将参数寄存器 (a0) 的值保存到栈中，偏移量为 -20 字节。  a0 通常用于传递函数的第一个参数。  这里将参数保存在栈上，可以看作是局部变量。
    lw      a5, -20(s0)  # 加载参数：将栈中偏移量为 -20 字节的值加载到寄存器 a5 中。  将之前保存的参数加载到 a5 中。
    addi    a5, a5, 1    # 参数加一：将寄存器 a5 的值加 1。  对参数进行加一操作。
    sw      a5, -20(s0)  # 保存结果：将寄存器 a5 的值保存到栈中，偏移量为 -20 字节。  将加一后的结果保存回栈中。
    lw      a5, -20(s0)  # 重新加载：将栈中偏移量为 -20 字节的值加载到寄存器 a5 中。 再次从栈中加载更新后的值。
    mv      a0, a5       # 设置返回值：将寄存器 a5 的值移动到寄存器 a0 中。  a0 通常用于返回函数的结果。
    lw      ra, 28(sp)   # 恢复返回地址：从栈中恢复返回地址寄存器 (ra) 的值。  准备返回到调用者。
    lw      s0, 24(sp)   # 恢复帧指针：从栈中恢复帧指针寄存器 (s0) 的值。  恢复调用者的栈帧。
    addi    sp, sp, 32   # 释放栈空间：将栈指针 (sp) 加上 32 字节，释放栈帧。  恢复栈指针到调用者状态。
    jr      ra           # 跳转返回：跳转到返回地址寄存器 (ra) 中保存的地址，返回到调用者。
```
